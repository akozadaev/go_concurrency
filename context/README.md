# –ü—Ä–∏–º–µ—Ä 1
 [main.go](main.go)
---

## **–û–±—â–∞—è —Ü–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º–º—ã**

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`context.Context`)** –≤ Go –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ **—Ç–∞–π–º–∞—É—Ç–æ–≤** –∏–ª–∏ **–æ—Ç–º–µ–Ω—ã –∑–∞–¥–∞—á–∏**.  
–§—É–Ω–∫—Ü–∏—è `task` –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (–∑–∞–Ω–∏–º–∞—é—â—É—é 2 —Å–µ–∫—É–Ω–¥—ã), –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ—Ä–≤–∞–Ω–∞, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–∞ –∏–ª–∏ —è–≤–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ `cancel()`).

---

## **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã**

```go
import (
	"context"
	"fmt"
	"time"
)
```

- **`context`** ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∏–ø `Context` –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã, —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –∑–Ω–∞—á–µ–Ω–∏–π –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏.
- **`fmt`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Å–æ–ª—å.
- **`time`** ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ (`Sleep`) –∏ —Ç–∞–π–º–µ—Ä–∞–º–∏ (`After`).

---

## **–§—É–Ω–∫—Ü–∏—è `task(ctx context.Context) (string, error)`**

```go
func task(ctx context.Context) (string, error) {
	select {
	case <-ctx.Done():
		return "", ctx.Err() // –æ—à–∏–±–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞
	case <-time.After(2 * time.Second):
		return "—É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ", nil
	}
}
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ú–æ–¥–µ–ª–∏—Ä—É–µ—Ç **–¥–æ–ª–≥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é**, –∫–æ—Ç–æ—Ä–∞—è:
- –ª–∏–±–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ —á–µ—Ä–µ–∑ **2 —Å–µ–∫—É–Ω–¥—ã**,
- –ª–∏–±–æ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –¥–æ—Å—Ä–æ—á–Ω–æ, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ç–∞–π–º–∞—É—Ç—É –∏–ª–∏ –æ—Ç–º–µ–Ω–µ).

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **`select`** ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Go –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤.
- **–ü–µ—Ä–≤—ã–π –∫–µ–π—Å**: `<-ctx.Done()`
    - –ö–∞–Ω–∞–ª `ctx.Done()` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç **–æ—Ç–º–µ–Ω—è–µ—Ç—Å—è** –∏–ª–∏ **–∏—Å—Ç–µ–∫–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç**.
    - –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É –∏ –æ—à–∏–±–∫—É –∏–∑ `ctx.Err()` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `context.DeadlineExceeded`).
- **–í—Ç–æ—Ä–æ–π –∫–µ–π—Å**: `<-time.After(2 * time.Second)`
    - –°–æ–∑–¥–∞—ë—Ç—Å—è —Ç–∞–π–º–µ—Ä –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã. –ï—Å–ª–∏ –æ–Ω —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **—Ä–∞–Ω—å—à–µ**, —á–µ–º —Å—Ä–∞–±–æ—Ç–∞–µ—Ç `ctx.Done()`, –æ–ø–µ—Ä–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ–π.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: `select` –≤—ã–±–∏—Ä–∞–µ—Ç **–ø–µ—Ä–≤—ã–π –≥–æ—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª**. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ: –µ—Å–ª–∏ —Ç–∞–π–º–∞—É—Ç —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–Ω—å—à–µ 2 —Å–µ–∫—É–Ω–¥ ‚Äî –∑–∞–¥–∞—á–∞ –ø—Ä–µ—Ä–≤—ë—Ç—Å—è; –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ.

---

## **–§—É–Ω–∫—Ü–∏—è `main()`**

```go
func main() {
	ctx, cancel := context.WithTimeout(context.Background(), 1*time.Second) // —Ç–∞–π–º–∞—É—Ç
	//ctx, cancel := context.WithTimeout(context.Background(), 3*time.Second) // –£—Å–ø–µ—Ö
	time.Sleep(500 * time.Millisecond)
	cancel()
	defer cancel()
	result, err := task(ctx)
	if err != nil {
		if err == context.DeadlineExceeded {
			fmt.Println("–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ–∂–∏–¥–∞–Ω–∏—è")
		} else {
			fmt.Printf("–û—à–∏–±–∫–∞: %v\n", err)
		}
		//return
	}
	fmt.Println(result)
}
```

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º

```go
ctx, cancel := context.WithTimeout(context.Background(), 1*time.Second)
```

- –°–æ–∑–¥–∞—ë—Ç—Å—è **–∫–æ–Ω—Ç–µ–∫—Å—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º 1 —Å–µ–∫—É–Ω–¥–∞**.
- –ß–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ **–æ—Ç–º–µ–Ω—è–µ—Ç—Å—è**, –∏ `ctx.Done()` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `cancel()`, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è **–æ—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é** —Ä–∞–Ω—å—à–µ —Å—Ä–æ–∫–∞.

> üí° –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É: –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç **3 —Å–µ–∫—É–Ω–¥—ã**, –∑–∞–¥–∞—á–∞ (2 —Å–µ–∫) —É—Å–ø–µ–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ.

### –®–∞–≥ 2: –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∏ —Ä—É—á–Ω–∞—è –æ—Ç–º–µ–Ω–∞

```go
time.Sleep(500 * time.Millisecond)
cancel()
defer cancel()
```

- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∂–¥—ë—Ç **500 –º—Å**, –∑–∞—Ç–µ–º **–≤—Ä—É—á–Ω—É—é –≤—ã–∑—ã–≤–∞–µ—Ç `cancel()`**.
- –≠—Ç–æ **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç** —É–∂–µ —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥—ã ‚Äî **—Ä–∞–Ω—å—à–µ**, —á–µ–º –∏—Å—Ç–µ—á—ë—Ç —Ç–∞–π–º–∞—É—Ç –≤ 1 —Å–µ–∫—É–Ω–¥—É.
- `defer cancel()` ‚Äî —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ `cancel` –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –¥–æ—Å—Ä–æ—á–Ω–æ–º `return`).
  > ‚ö†Ô∏è **–ù–æ –∑–¥–µ—Å—å —ç—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ**, –ø–æ—Ç–æ–º—É —á—Ç–æ `cancel()` —É–∂–µ –≤—ã–∑–≤–∞–Ω —è–≤–Ω–æ. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ `cancel()` –±–µ–∑–æ–ø–∞—Å–µ–Ω, –Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω.

> üìù **–ó–∞–º–µ—á–∞–Ω–∏–µ**: –ü–æ—Å–∫–æ–ª—å–∫—É `cancel()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–¥–æ** –≤—ã–∑–æ–≤–∞ `task(ctx)`, –∫–æ–Ω—Ç–µ–∫—Å—Ç —É–∂–µ **–æ—Ç–º–µ–Ω—ë–Ω** –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞—á–∏.

### –®–∞–≥ 3: –í—ã–∑–æ–≤ –∑–∞–¥–∞—á–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```go
result, err := task(ctx)
```

- –§—É–Ω–∫—Ü–∏—è `task` –ø–æ–ª—É—á–∞–µ—Ç **—É–∂–µ –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**.
- –ü–æ—ç—Ç–æ–º—É `ctx.Done()` **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≥–æ—Ç–æ–≤** –∫ —á—Ç–µ–Ω–∏—é.
- `select` –≤ `task` —Å—Ä–∞–∑—É –≤—ã–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–≤—ã–π –∫–µ–π—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É.

### –®–∞–≥ 4: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏

```go
if err != nil {
	if err == context.DeadlineExceeded {
		fmt.Println("–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ–∂–∏–¥–∞–Ω–∏—è")
	} else {
		fmt.Printf("–û—à–∏–±–∫–∞: %v\n", err)
	}
}
fmt.Println(result)
```

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞.
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî —ç—Ç–æ `context.DeadlineExceeded`, –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—à–∏–±–∫–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–æ–¥–∏—Ç `result` (–≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ ‚Äî –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É).

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ `fmt.Println(result)` –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –Ω–∞–ø–µ—á–∞—Ç–∞–≤ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ ‚Äî –æ–±—ã—á–Ω–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç.

---

## **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö**

–¢–∞–∫ –∫–∞–∫:
- —Ç–∞–π–º–∞—É—Ç = **1 —Å–µ–∫—É–Ω–¥–∞**,
- –Ω–æ `cancel()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **0.5 —Å–µ–∫—É–Ω–¥—ã**,
- –∞ –∑–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç **2 —Å–µ–∫—É–Ω–¥—ã**,

—Ç–æ **–∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –¥–æ –Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏**, –∏ `task` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É.

### üî∏ –í—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã:
```
–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ–∂–∏–¥–∞–Ω–∏—è

```
(–ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç `fmt.Println(result)`)

> üí° –ï—Å–ª–∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É —Å —Ç–∞–π–º–∞—É—Ç–æ–º **3 —Å–µ–∫—É–Ω–¥—ã** –∏ **–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** `cancel()`, —Ç–æ –∑–∞–¥–∞—á–∞ —É—Å–ø–µ–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è, –∏ –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç:
```
—É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
```

---

## **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Go, –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ**

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|
| **`context.Context`** | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏. |
| **`context.WithTimeout`** | –°–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. |
| **`ctx.Done()`** | –ö–∞–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è. |
| **`ctx.Err()`** | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É –æ—Ç–º–µ–Ω—ã (`context.Canceled` –∏–ª–∏ `context.DeadlineExceeded`). |
| **`select` —Å –∫–∞–Ω–∞–ª–∞–º–∏** | –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ –∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π (—Ç–∞–π–º–∞—É—Ç vs –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏). |
| **–†—É—á–Ω–∞—è –æ—Ç–º–µ–Ω–∞ —á–µ—Ä–µ–∑ `cancel()`** | –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ä–æ—á–Ω–æ –ø—Ä–µ—Ä–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é –ø–æ –ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. |

---

## **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–¥–∞**

1. **–£–±—Ä–∞—Ç—å `defer cancel()`**, –µ—Å–ª–∏ `cancel()` —É–∂–µ –≤—ã–∑–≤–∞–Ω —è–≤–Ω–æ:
   ```go
   time.Sleep(500 * time.Millisecond)
   cancel() // –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞
   // defer cancel() ‚Äî –Ω–µ –Ω—É–∂–µ–Ω
   ```

2. **–ù–µ –≤—ã–≤–æ–¥–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ**:
   ```go
   if err != nil {
       // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
   } else {
       fmt.Println(result)
   }
   ```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `context.WithCancel`**, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω —Ç–∞–π–º–∞—É—Ç, –∞ —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–∞—è –æ—Ç–º–µ–Ω–∞.

---

## **–í—ã–≤–æ–¥ –ø–æ –ø—Ä–∏–º–µ—Ä—É 1**

–≠—Ç–æ—Ç –∫–æ–¥ ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä **—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π** –≤ Go —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫:
- –∑–∞–¥–∞–≤–∞—Ç—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è**,
- **–≤—Ä—É—á–Ω—É—é –æ—Ç–º–µ–Ω—è—Ç—å** –æ–ø–µ—Ä–∞—Ü–∏–∏,
- **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å** –æ—à–∏–±–∫–∏ –æ—Ç–º–µ–Ω—ã –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤,
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`select`** –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏, –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –≤–Ω–µ—à–Ω–∏–º–∏ API –∏ –¥—Ä—É–≥–∏–º–∏ –±–ª–æ–∫–∏—Ä—É—é—â–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏, –≥–¥–µ –≤–∞–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å "–∑–∞–≤–∏—Å–∞–Ω–∏–π".

____
# –ü—Ä–∏–º–µ—Ä 2
[main_cancel.go](main_cancel.go)

–í–æ—Ç **–ø–æ–ª–Ω–æ–µ –∏ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ —è–∑—ã–∫–µ Go:

---

## **–û–±—â–∞—è —Ü–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º–º—ã**

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –≥–æ—Ä—É—Ç–∏–Ω—ã** —Å –ø–æ–º–æ—â—å—é –º–µ—Ö–∞–Ω–∏–∑–º–∞ **–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`context.Context`)**.  
–ì–æ—Ä—É—Ç–∏–Ω–∞ `worker` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é —Ä–∞–±–æ—Ç—É (–∫–∞–∂–¥—ã–µ 500 –º—Å), –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞** –ø–æ —Å–∏–≥–Ω–∞–ª—É –æ—Ç–º–µ–Ω—ã –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `main`. –≠—Ç–æ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –≤ Go.

---

## **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã**

```go
import (
	"context"
	"fmt"
	"time"
)
```

- **`context`** ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∏–ø `Context` –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏.
- **`fmt`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–æ–Ω—Å–æ–ª—å.
- **`time`** ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ (`Sleep`) –∏ —Ç–∞–π–º–µ—Ä–∞–º–∏ (`After`).

---

## **–§—É–Ω–∫—Ü–∏—è `worker(ctx context.Context)`**

```go
func worker(ctx context.Context) {
	for {
		select {
		case <-ctx.Done():
			fmt.Println("–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –æ—Ç–º–µ–Ω—ã: ", ctx.Err())
			return
		case <-time.After(500 * time.Millisecond):
			fmt.Println("–†–∞–±–æ—Ç–∞—é")
		}
	}
}
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–≠—Ç–æ **—Ñ–æ–Ω–æ–≤–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞**, –∫–æ—Ç–æ—Ä–∞—è:
- –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ü–∏–∫–ª,
- –∫–∞–∂–¥—ã–µ **500 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥** –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `"–†–∞–±–æ—Ç–∞—é"`,
- –Ω–æ **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è**, –µ—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –æ—Ç–º–µ–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

- **–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª `for {}`** ‚Äî —Ç–∏–ø–∏—á–µ–Ω –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, —Å–ª—É—à–∞—Ç–µ–ª–µ–π, —Ç–∞–π–º–µ—Ä–æ–≤).
- **`select`** ‚Äî –∫–ª—é—á–µ–≤–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤:
    - **–ü–µ—Ä–≤—ã–π –∫–µ–π—Å**: `<-ctx.Done()`
        - –ö–∞–Ω–∞–ª `ctx.Done()` **–∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è**, –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è (–≤—ã–∑–æ–≤–æ–º `cancel()`).
        - –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞:
            - –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–º–µ–Ω—ã (`ctx.Err()` ‚Äî –æ–±—ã—á–Ω–æ `context.Canceled`),
            - —Ñ—É–Ω–∫—Ü–∏—è **–∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è** (`return`), –∏ –≥–æ—Ä—É—Ç–∏–Ω–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.
    - **–í—Ç–æ—Ä–æ–π –∫–µ–π—Å**: `<-time.After(500 * time.Millisecond)`
        - –°–æ–∑–¥–∞—ë—Ç—Å—è **–Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä** –Ω–∞ –∫–∞–∂–¥—É—é –∏—Ç–µ—Ä–∞—Ü–∏—é —Ü–∏–∫–ª–∞.
        - –ß–µ—Ä–µ–∑ 500 –º—Å —Ç–∞–π–º–µ—Ä —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è `"–†–∞–±–æ—Ç–∞—é"`.
        - –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: `time.After(500 * time.Millisecond)` —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏**. –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤, –Ω–æ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º –∫–æ–¥–µ –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `time.Ticker`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–∞–π–º–µ—Ä–æ–≤.

---

## **–§—É–Ω–∫—Ü–∏—è `main()`**

```go
func main() {
	ctx, cancel := context.WithCancel(context.Background())
	go worker(ctx)
	time.Sleep(2 * time.Second)
	cancel()
	time.Sleep(1 * time.Second)
}
```

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–º–µ–Ω—è–µ–º–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```go
ctx, cancel := context.WithCancel(context.Background())
```

- –°–æ–∑–¥–∞—ë—Ç—Å—è **–∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é**.
- `context.Background()` ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è:
    - `ctx` ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –≤ –≥–æ—Ä—É—Ç–∏–Ω—É,
    - `cancel` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑–æ–≤ –∫–æ—Ç–æ—Ä–æ–π **–æ—Ç–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç** –∏ —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–± —ç—Ç–æ–º —á–µ—Ä–µ–∑ `ctx.Done()`.

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –≥–æ—Ä—É—Ç–∏–Ω—ã

```go
go worker(ctx)
```

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≥–æ—Ä—É—Ç–∏–Ω–∞ `worker`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.
- –û–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç `ctx`, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ–∂–µ—Ç —É–∑–Ω–∞—Ç—å –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è.

### –®–∞–≥ 3: –û–∂–∏–¥–∞–Ω–∏–µ 2 —Å–µ–∫—É–Ω–¥—ã

```go
time.Sleep(2 * time.Second)
```

- –û—Å–Ω–æ–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ (`main`) **–ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã**.
- –ó–∞ —ç—Ç–æ –≤—Ä–µ–º—è `worker` —É—Å–ø–µ–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ **4 –∏—Ç–µ—Ä–∞—Ü–∏–∏** (2000 –º—Å / 500 –º—Å = 4 —Ä–∞–∑–∞), –≤—ã–≤–æ–¥—è `"–†–∞–±–æ—Ç–∞—é"`.

### –®–∞–≥ 4: –û—Ç–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```go
cancel()
```

- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–º–µ–Ω—ã ‚Äî **—Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–æ—Ä—É—Ç–∏–Ω–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è**.
- –í–Ω—É—Ç—Ä–∏ `worker` –∫–∞–Ω–∞–ª `ctx.Done()` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è, –∏ –≥–æ—Ä—É—Ç–∏–Ω–∞ –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ —Ü–∏–∫–ª–∞.

### –®–∞–≥ 5: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

```go
time.Sleep(1 * time.Second)
```

- –î–∞—ë—Ç **–≤—Ä–µ–º—è –≥–æ—Ä—É—Ç–∏–Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è** –∏ –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–º–µ–Ω–µ.
- –ë–µ–∑ —ç—Ç–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–≥–ª–∞ –±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è **—Å—Ä–∞–∑—É –ø–æ—Å–ª–µ `cancel()`**, –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ `"–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –æ—Ç–º–µ–Ω—ã..."` **–Ω–µ —É—Å–ø–µ–ª–æ –±—ã –Ω–∞–ø–µ—á–∞—Ç–∞—Ç—å—Å—è** (—Ç–∞–∫ –∫–∞–∫ `main` –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—Å—é –ø—Ä–æ–≥—Ä–∞–º–º—É).

> üí° –≠—Ç–æ **–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**. –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω –∏—Å–ø–æ–ª—å–∑—É—é—Ç `sync.WaitGroup` –∏–ª–∏ –∫–∞–Ω–∞–ª—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

---

## **–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã**

```
–†–∞–±–æ—Ç–∞—é
–†–∞–±–æ—Ç–∞—é
–†–∞–±–æ—Ç–∞—é
–†–∞–±–æ—Ç–∞—é
–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –æ—Ç–º–µ–Ω—ã:  context canceled
```

- –¢–æ—á–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–æ–≥—É—Ç –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤–∞—Ä—å–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ Go.
- –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ `cancel()`**, –Ω–æ **–¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `main`**.

---

## **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Go, –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ**

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|
| **–ì–æ—Ä—É—Ç–∏–Ω—ã (`go func()`)** | –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã. |
| **`context.Context`** | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏. |
| **`context.WithCancel`** | –°–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é. |
| **`ctx.Done()`** | –ö–∞–Ω–∞–ª, –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞. |
| **`select`** | –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–∂–∏–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ (—Ä–∞–±–æ—Ç–∞ vs –æ—Ç–º–µ–Ω–∞). |
| **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≥–æ—Ä—É—Ç–∏–Ω** | –í–∞–∂–Ω–æ –¥–∞–≤–∞—Ç—å –≥–æ—Ä—É—Ç–∏–Ω–∞–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "—É–∑–Ω–∞—Ç—å" –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏ –ø–æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã. |

---

## **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è**

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `time.Ticker` –≤–º–µ—Å—Ç–æ `time.After` –≤ —Ü–∏–∫–ª–µ**:
   ```go
   ticker := time.NewTicker(500 * time.Millisecond)
   defer ticker.Stop()
   for {
       select {
       case <-ctx.Done():
           fmt.Println("–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –æ—Ç–º–µ–Ω—ã:", ctx.Err())
           return
       case <-ticker.C:
           fmt.Println("–†–∞–±–æ—Ç–∞—é")
       }
   }
   ```
   –≠—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.

2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ `sync.WaitGroup`** (–≤–º–µ—Å—Ç–æ `time.Sleep`):
   ```go
   var wg sync.WaitGroup
   wg.Add(1)
   go func() {
       defer wg.Done()
       worker(ctx)
   }()
   // ...
   cancel()
   wg.Wait() // –∂–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥–æ—Ä—É—Ç–∏–Ω—ã
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å `defer cancel()`** –≤ `main` ‚Äî —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ (—Ö–æ—Ç—è –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ).

---

## **–í—ã–≤–æ–¥ –ø–æ –ø—Ä–∏–º–µ—Ä—É 2**


–≠—Ç–æ—Ç –∫–æ–¥ ‚Äî **–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä** –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤–æ–π –≥–æ—Ä—É—Ç–∏–Ω–æ–π –≤ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.  
–û–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫:
- –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–ª–≥–æ–∂–∏–≤—É—â—É—é –∑–∞–¥–∞—á—É,
- –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É,
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ –≤–Ω–µ—à–Ω–µ–º—É —Å–∏–≥–Ω–∞–ª—É,
- –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–µ–∫ –≥–æ—Ä—É—Ç–∏–Ω –∏ "–∑–∞–≤–∏—Å–∞–Ω–∏–π".

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Å–µ—Ä–≤–µ—Ä–∞—Ö, –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö —Å–æ–±—ã—Ç–∏–π –∏ –ª—é–±—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

# –ü—Ä–∏–º–µ—Ä 3

[main_value.go](main_value.go)
---

## **–û–±—â–∞—è —Ü–µ–ª—å –ø—Ä–æ–≥—Ä–∞–º–º—ã**

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`context.Context`)** –¥–ª—è **–ø–µ—Ä–µ–¥–∞—á–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π** (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞) –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –≤ Go.  
–≠—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, ID –∑–∞–ø—Ä–æ—Å–∞, —Ç–æ–∫–µ–Ω–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö) **–≤–≥–ª—É–±—å —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–æ–≤**, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞—Ö –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

---

## **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã**

```go
import (
	"context"
	"fmt"
)
```

- **`context`** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞–∫–µ—Ç Go –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–π, –æ—Ç–º–µ–Ω—ã –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∑–Ω–∞—á–µ–Ω–∏–π.
- **`fmt`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Å–æ–ª—å.

---

## **–§—É–Ω–∫—Ü–∏—è `process(ctx context.Context)`**

```go
func process(ctx context.Context) {
	id := ctx.Value("ID")
	fmt.Println("process id: ", id)
}
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Å –∫–ª—é—á–æ–º `"ID"` –∏–∑ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –≤—ã–≤–æ–¥–∏—Ç –µ–≥–æ.

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã
- **`ctx.Value(key interface{}) interface{}`** ‚Äî –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –∑–Ω–∞—á–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–ª—é—á–æ–º.
    - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `interface{}`, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–Ω–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω**.
    - –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `nil`.
- –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∫–ª—é—á ‚Äî —Å—Ç—Ä–æ–∫–∞ `"ID"`, –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Å—Ç—Ä–æ–∫–∞ `"121rdv-4df"`.
- –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ `fmt.Println`.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: `ctx.Value()` **–Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏**. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**, —Ç–∞–∫–∏—Ö –∫–∞–∫:
> - ID —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ (trace ID),
> - ID –∑–∞–ø—Ä–æ—Å–∞ (request ID),
> - –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (user ID, —Ç–æ–∫–µ–Ω—ã),
> - –ª–æ–∫–∞–ª—å (—è–∑—ã–∫, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å).

---

## **–§—É–Ω–∫—Ü–∏—è `main()`**

```go
func main() {
	parentCtx := context.Background()
	ctx := context.WithValue(parentCtx, "ID", "121rdv-4df")
	process(ctx)
}
```

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

```go
parentCtx := context.Background()
```

- `context.Background()` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ø—É—Å—Ç–æ–π –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**, –∫–æ—Ç–æ—Ä—ã–π **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è**.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤.

### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç

```go
ctx := context.WithValue(parentCtx, "ID", "121rdv-4df")
```

- **`context.WithValue(parent, key, val)`** —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**, –∫–æ—Ç–æ—Ä—ã–π:
    - –Ω–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å—ë –æ—Ç `parentCtx`,
    - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç –ø–∞—Ä—É **–∫–ª—é—á‚Äì–∑–Ω–∞—á–µ–Ω–∏–µ**.
- **–ö–ª—é—á** ‚Äî `"ID"` (—Ç–∏–ø `string`),
- **–ó–Ω–∞—á–µ–Ω–∏–µ** ‚Äî `"121rdv-4df"` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä, ID –∑–∞–ø—Ä–æ—Å–∞).

> ‚ö†Ô∏è **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∫–ª—é—á–∞–º**:  
> –•–æ—Ç—è –≤ –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ `"ID"` –∫–∞–∫ –∫–ª—é—á, **–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Go —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–ª–ª–∏–∑–∏–π –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏.  
> –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
> ```go
> type ctxKey string
> const requestIDKey ctxKey = "requestID"
> ctx := context.WithValue(parent, requestIDKey, "121rdv-4df")
> ```
> –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### –®–∞–≥ 3: –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

```go
process(ctx)
```

- –ü–µ—Ä–µ–¥–∞—ë—Ç –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Ñ—É–Ω–∫—Ü–∏—é `process`.
- –§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã–≤–æ–¥–∏—Ç –µ–≥–æ.

---

## **–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã**

```
process id:  121rdv-4df
```

---

## **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ Go, –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ**

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|
| **`context.Context`** | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤ —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –≤—ã–∑–æ–≤–æ–≤. |
| **`context.WithValue`** | –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ –∫–ª—é—á—É. |
| **`ctx.Value(key)`** | –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ –∫–ª—é—á—É. |
| **–ü–µ—Ä–µ–¥–∞—á–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** | –ö–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± "–ø—Ä–æ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è" –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, ID –∑–∞–ø—Ä–æ—Å–∞) –±–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ñ—É–Ω–∫—Ü–∏–π. |

---

## **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `context.WithValue`?**

‚úÖ **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è**:
- –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è (request ID, user ID),
- –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ (trace/span ID),
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω—ã, —Ä–æ–ª–∏),
- –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ (—è–∑—ã–∫, —Ä–µ–≥–∏–æ–Ω).

‚ùå **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è**:
- –ü–µ—Ä–µ–¥–∞—á–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏,
- –•—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö,
- –ü–µ—Ä–µ–¥–∞—á–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ –¥–ª—è —ç—Ç–æ–≥–æ).

---

## **–í—ã–≤–æ–¥**

–≠—Ç–æ—Ç –∫–æ–¥ ‚Äî –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –≤–∞–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä **–ø–µ—Ä–µ–¥–∞—á–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç** –≤ Go.  
–û–Ω –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç,
- –∫–∞–∫ –∏–∑–≤–ª–µ—á—å –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏,
- –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏ "–ø—Ä–æ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏" –¥–∞–Ω–Ω—ã—Ö.

–•–æ—Ç—è –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–π –∫–ª—é—á (—á—Ç–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ production), –æ–Ω —á—ë—Ç–∫–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ—é: **–∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî —ç—Ç–æ "—Ä—é–∫–∑–∞–∫" –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**, —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å –ø–æ —Ü–µ–ø–æ—á–∫–µ –≤—ã–∑–æ–≤–æ–≤.

–ü—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ (—Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ `nil`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö) —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–∞–¥—ë–∂–Ω—ã—Ö –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Go.